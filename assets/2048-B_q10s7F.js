import{r as c,j as o}from"./index-CLPAqlh6.js";const M=()=>{const[d,g]=c.useState([]),[E,b]=c.useState(0),[m,p]=c.useState("not over"),[l,w]=c.useState([]),I=t=>t.flat(),j=t=>I(t).includes(0),f=t=>t[0].map((e,r)=>t.map(s=>s[r])),h=t=>t.map(e=>[...e].reverse()),S=t=>JSON.parse(JSON.stringify(t)),R=t=>Array(t).fill().map(()=>Array(t).fill(0)),v=t=>{if(!j(t))return t;const e=S(t),r=[];I(e).forEach((a,Z)=>{a===0&&r.push(Z)});const s=r[Math.floor(Math.random()*r.length)],i=Math.floor(s/4),n=s%4;return e[i][n]=2,e},k=c.useCallback(()=>{let t=R(4);t=v(v(t)),g(t),b(0),p("not over"),w([])},[]),N=t=>{if(I(t).includes(2048))return"win";if(j(t))return"not over";for(let r=0;r<4;r++)for(let s=1;s<4;s++)if(t[r][s]===t[r][s-1])return"not over";const e=f(t);for(let r=0;r<4;r++)for(let s=1;s<4;s++)if(e[r][s]===e[r][s-1])return"not over";return"lose"},G=t=>t.map(e=>{const r=e.filter(s=>s!==0);return[...r,...Array(4-r.length).fill(0)]}),x=t=>{const e=S(t);let r=G(t),s=0;for(let n=0;n<4;n++)for(let a=0;a<3;a++)r[n][a]===r[n][a+1]&&r[n][a]!==0&&(r[n][a]*=2,r[n][a+1]=0,s+=r[n][a]);r=G(r);const i=JSON.stringify(e)!==JSON.stringify(r);return[r,i,s]},u=c.useCallback(t=>{let e=S(d),r=!1,s=0;switch(t){case"left":[e,r,s]=x(e);break;case"right":e=h(e),[e,r,s]=x(e),e=h(e);break;case"up":e=f(e),[e,r,s]=x(e),e=f(e);break;case"down":e=f(e),e=h(e),[e,r,s]=x(e),e=h(e),e=f(e);break}r&&(l.length===3&&l.shift(),w(i=>[...i,{matrix:e,score:s}]),e=v(e),g(e),b(i=>i+s),p(N(e)))},[d,l]),C=c.useCallback(()=>{if(l.length===0)return;const t=l[l.length-1];g(t.matrix),b(e=>e-t.score),w(e=>e.slice(0,-1)),p("not over")},[l]),y=c.useCallback(t=>{if(m==="not over")switch(t.key){case"ArrowLeft":u("left");break;case"ArrowRight":u("right");break;case"ArrowUp":u("up");break;case"ArrowDown":u("down");break}},[m,u]);c.useEffect(()=>(d.length===0&&k(),window.addEventListener("keydown",y),()=>window.removeEventListener("keydown",y)),[y,k,d.length]);const D=t=>({0:"#eee",2:"#eee4da",4:"#ede0c8",8:"#f2b179",16:"#f59563",32:"#f67c5f",64:"#f65e3b",128:"#edcf72",256:"#edcc61",512:"#edc850",1024:"#edc53f",2048:"#edc22e"})[t]||"#edc22e";return o.jsxs("div",{className:"flex flex-col items-center p-4",children:[o.jsx("h1",{className:"text-4xl font-bold mb-4",children:"2048"}),o.jsxs("div",{className:"mb-4 flex justify-between w-full max-w-md",children:[o.jsxs("div",{className:"text-xl font-bold",children:["Score: ",E]}),o.jsxs("div",{className:"space-x-2",children:[o.jsx("button",{className:"button-89 my-5 ml-60 md:ml-0",onClick:k,children:"New Game"}),o.jsx("button",{className:"button-89 my-5 ml-60 md:ml-0",onClick:C,disabled:l.length===0,children:"Undo"})]})]}),o.jsx("div",{className:"bg-gray-300 p-4 rounded-lg",children:o.jsx("div",{className:"grid grid-cols-4 gap-2",children:d.map((t,e)=>t.map((r,s)=>o.jsx("div",{style:{backgroundColor:D(r),height:"64px",width:"64px",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",fontSize:"1.5rem",borderRadius:"0.5rem",transition:"background-color 0.15s ease-in-out",color:"black"},children:r!==0?r:""},`${e}-${s}`)))})}),m!=="not over"&&o.jsx("div",{className:"mt-4 text-xl font-bold",children:m==="win"?"Congratulations! You won!":"Game Over!"})]})};export{M as default};
