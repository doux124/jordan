import{r,u as z,j as o}from"./index-CNuYfULY.js";import{F as U,f as F}from"./faHome-LweQ82Y9.js";const P=()=>{const[f,g]=r.useState([]),[D,b]=r.useState(0),[h,p]=r.useState("not over"),[i,S]=r.useState([]),[v,G]=r.useState(null),[w,y]=r.useState(null),Z=z(),_=50,I=t=>t.flat(),R=t=>I(t).includes(0),u=t=>t[0].map((e,s)=>t.map(n=>n[s])),m=t=>t.map(e=>[...e].reverse()),j=t=>JSON.parse(JSON.stringify(t)),M=t=>Array(t).fill().map(()=>Array(t).fill(0)),k=t=>{if(!R(t))return t;const e=j(t),s=[];I(e).forEach((c,X)=>{c===0&&s.push(X)});const n=s[Math.floor(Math.random()*s.length)],d=Math.floor(n/4),a=n%4;return e[d][a]=2,e},E=r.useCallback(()=>{let t=M(4);t=k(k(t)),g(t),b(0),p("not over"),S([])},[]),T=t=>{y(null),G({x:t.targetTouches[0].clientX,y:t.targetTouches[0].clientY})},A=t=>{y({x:t.targetTouches[0].clientX,y:t.targetTouches[0].clientY})},L=()=>{if(!v||!w)return;const t=v.x-w.x,e=v.y-w.y,s=Math.abs(t),n=Math.abs(e);Math.max(s,n)<_||(s>n?t>0?l("left"):l("right"):e>0?l("up"):l("down"),G(null),y(null))},O=t=>{if(I(t).includes(2048))return"win";if(R(t))return"not over";for(let s=0;s<4;s++)for(let n=1;n<4;n++)if(t[s][n]===t[s][n-1])return"not over";const e=u(t);for(let s=0;s<4;s++)for(let n=1;n<4;n++)if(e[s][n]===e[s][n-1])return"not over";return"lose"},C=t=>t.map(e=>{const s=e.filter(n=>n!==0);return[...s,...Array(4-s.length).fill(0)]}),x=t=>{const e=j(t);let s=C(t),n=0;for(let a=0;a<4;a++)for(let c=0;c<3;c++)s[a][c]===s[a][c+1]&&s[a][c]!==0&&(s[a][c]*=2,s[a][c+1]=0,n+=s[a][c]);s=C(s);const d=JSON.stringify(e)!==JSON.stringify(s);return[s,d,n]},l=r.useCallback(t=>{let e=j(f),s=!1,n=0;switch(t){case"left":[e,s,n]=x(e);break;case"right":e=m(e),[e,s,n]=x(e),e=m(e);break;case"up":e=u(e),[e,s,n]=x(e),e=u(e);break;case"down":e=u(e),e=m(e),[e,s,n]=x(e),e=m(e),e=u(e);break}s&&(i.length===3&&i.shift(),S(d=>[...d,{matrix:e,score:n}]),e=k(e),g(e),b(d=>d+n),p(O(e)))},[f,i]),Y=r.useCallback(()=>{if(i.length===0)return;const t=i[i.length-1];g(t.matrix),b(e=>e-t.score),S(e=>e.slice(0,-1)),p("not over")},[i]),N=r.useCallback(t=>{if(h==="not over")switch(t.key){case"ArrowLeft":l("left");break;case"ArrowRight":l("right");break;case"ArrowUp":l("up");break;case"ArrowDown":l("down");break}},[h,l]);r.useEffect(()=>(f.length===0&&E(),window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)),[N,E,f.length]);const J=t=>({0:"#eee",2:"#eee4da",4:"#ede0c8",8:"#f2b179",16:"#f59563",32:"#f67c5f",64:"#f65e3b",128:"#edcf72",256:"#edcc61",512:"#edc850",1024:"#edc53f",2048:"#edc22e"})[t]||"#edc22e";return o.jsxs("div",{className:"flex flex-col items-center p-4",children:[o.jsxs("div",{className:"relative flex justify-center items-center w-full my-8",children:[o.jsx("h1",{className:"text-4xl font-bold",children:"2048"}),o.jsx("nav",{className:"absolute right-2 text-2xl",children:o.jsx("a",{className:"navLink",onClick:()=>Z("/tools"),children:o.jsx(U,{icon:F.faHome,style:{fontSize:"30px"}})})})]}),o.jsxs("div",{className:"mb-4 flex flex-center justify-between w-full",children:[o.jsxs("div",{className:"text-xl font-bold pr-10",children:["Score: ",D]}),o.jsxs("div",{className:"space-x-2",children:[o.jsx("button",{className:"button-89 my-2 sm:my-5 ml-0",onClick:E,children:"New Game"}),o.jsx("button",{className:"button-89 my-2 sm:my-5 ml-0",onClick:Y,disabled:i.length===0,children:"Undo"})]})]}),o.jsx("div",{className:"bg-gray-300 p-4 rounded-lg touch-none",onTouchStart:T,onTouchMove:A,onTouchEnd:L,children:o.jsx("div",{className:"grid grid-cols-4 gap-2",children:f.map((t,e)=>t.map((s,n)=>o.jsx("div",{style:{backgroundColor:J(s),height:"64px",width:"64px",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",fontSize:"1.5rem",borderRadius:"0.5rem",transition:"background-color 0.15s ease-in-out",color:"black"},children:s!==0?s:""},`${e}-${n}`)))})}),h!=="not over"&&o.jsx("div",{className:"mt-4 text-xl font-bold",children:h==="win"?"Congratulations! You won!":"Game Over!"})]})};export{P as default};
